[TOC]

# 第二章 贝叶斯理论
> Markdown Revision 1

> Date: 2018/11/16

> Editor: kirisitngna

> Contact: https://www.github.com/Kiristingna

## 2.1 概率分布

定义: Z是一个随机变量，那么Z的观察值（输出值）应该是由一个概率分布函数海赋予各个值概率的。分为三种情况：

- 离散变量， 其概率分布称为概率质量函数 **probability mass function**。非常重要的一种离散分布为泊松分布（Possion distribution） **泊松分布就是描述某段时间内，事件具体的发生概率** .  λ 可为任意正数。
  $$
  P(Z=k) = \frac{\lambda^k e^{-\lambda}}{k!} ~ ~ ~ E[Z|\lambda] = \lambda
  $$
  增加 λ , 取值上大值的概率会增加, 相对的减少 λ, 取值上小值的概率会增加 ，形状上泊松分布是一个钟形。有时称 λ为 泊松分布的强度， 强度越小则钟形的峰向小值靠近且越来越高，反之强度越大则钟形的峰高度会降低，而且逐渐向大值靠近。整数 k 代表取值，k 取值集合 {0,1,2...}，注意这个参数不能是小数。

- 连续变量

- 混合变量



#### 二项分布、泊松分布和正太分布的关系

推论: 离散分布的近似是正态分布



如果 np 存在有限极限 λ，则这列二项分布就趋于参数为 λ 的 泊松分布。反之，如果 np 趋于无限大（如 p 是一个定值），则根据**德莫佛-拉普拉斯(De'Moivre-Laplace)中心极限定理**，这列二项分布将趋近于**正态分布**。实际运用中**当 n 很大时一般都用正态分布来近似计算二项分布**，但是如果**同时 np 又比较小**（比起 n来说很小），那么用**泊松分布**近似计算更简单些，毕竟泊松分布跟二项分布一样都是离散型分布。



####  朴素贝叶斯

考虑$X=\{x_i\}_{i=1}^n$代表数据，每一个$x_i$ 有 $j$ 列。那么二元 $x_{ij} = \{0, 1\}$ 代表词语出现或者没有出现过。每个$y_i$ 代表一个类别，那么正对二分类（只有0， 1）的情况有一个概率矩阵。 假设为1（正）的概率设为$\theta_{1}$, 那么0的概率就是$1-\theta_{1}$,正对$x_i$中每一个列元素都有一个概率值。那么
$$
P(x|c) =  \prod_{j} \theta_{1j}^{x_j}(1-\theta_{1j})^{1-x_j}\\
P(c|x) = P(x|c)P(c)/P(x)
$$
注意$P(x)$无关，$P(c)$称作“先验信息”，通常我们要人为地赋予其一个合理的概率值。只需要计算$P(x|c)$就能知道$P(c|x)$的情况。其中对于每一条样本的$\theta_{1j} = n(c=1, j \in x_i) /n(c=1)$. 这个取值的计算时常增加一些项，最常用的是拉普拉斯（Laplace）平滑
$$
\theta_{1j} = \frac{n(c=1, j \in x_i)+ \alpha}{n(c=1)+\beta}\\
\theta_{1j} = \frac{n(c=1, j \in x_i)+ 1}{n(c=1)+K}, C=\{c_1, c_2,\dots, c_k\}
$$
如果我们假设 $\theta$ 服从一个最简单地 $\beta$分布, 那么$\theta$ 的最大后验估计量就是上述所展示的拉普拉斯平滑值。对于词表问题，采用上述公式的第二个取值，简称加1平滑。
